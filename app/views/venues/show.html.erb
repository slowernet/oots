<% content_for :page_head do %>
	<link rel="stylesheet" href="//cdn.leafletjs.com/leaflet-0.4/leaflet.css" />
<% end %>

<% content_for :page_title do %>
	<%= "#{@venue.name} at #{@venue.address} in #{@venue.city} #{@venue.zip}" %>
<% end %>

<% content_for :page_body do %>
	<h1><%= @venue.name %></h1>

	<div style="position: relative; height: 190px;">
		<ul style="position: absolute; top: 0; left: 0; margin: 0; font-size: 19px">
			<li><%= @venue.address %></li>
			<li><%= @venue.city %> <%= @venue.state %> <%= @venue.zip %></li>
			<li><a href="tel:+1<%= @venue.try(:phone).try(:gsub, /\D/,'') %>"><%= format_phone @venue.phone %></a></li>
			<% unless @venue.foursquare_id.blank? %>
				<li><a href="http://foursquare.com/venue/<%= @venue.foursquare_id %>" target="_blank"><img src="/images/foursquare-icon.png" height="20" width="20" border="0" style="vertical-align: text-top;"> foursquare</a></li>
			<% end %>				
		</ul>
		<ul style="position: absolute; top: 0; right: 0; line-height: 1.2em;">
			<li>
				<div id="map" class="map" style="width: 400px; height: 200px;"></div>
				<a href="http://maps.google.com/?q=<%= URI.escape "#{@venue.name}, #{@venue.address}, #{@venue.city} #{@venue.zip}" %>" target="_blank" style="font-size: 70%; text-align: right;">
					big map
					<!-- <img height="158" width="400" src="http://maps.google.com/maps/api/staticmap?zoom=15&size=408x158&maptype=roadmap&markers=color:red|<%= "#{@venue.address},#{@venue.city} #{@venue.zip}" %>&sensor=false" alt="<%= @venue.name %>" border="0"> -->
				</a>
			</li>
		</ul>
	</div>
<% end %>

<% content_for :page_end do %>
	<script type="text/javascript" charset="utf-8">
		$script.ready('_bundle', function() {
			$(document).ready(function() {
				$('.map:visible:not(.intialized)').leaflet({
					points: <%= [[ @venue.latitude.to_f, @venue.longitude.to_f, @venue.name.to_s, @venue.permalink ]].to_json %>,
					markerClick: function(e) { e.target.options.click(e) }
				})
			});
		});
	</script>
<% end %>	